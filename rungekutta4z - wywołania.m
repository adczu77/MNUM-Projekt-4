f1 = @(x1,x2) x2 + x1*(0.7-(x1)^2-(x2)^2);
f2 = @(x1,x2) -x1 + x2*(0.7-(x1)^2-(x2)^2);
[x1v,x2v,t, H, E1, E2] = rungekutta4z(f1,f2,0,10,0.001,0,15,10^-10,10^-10,10^-16);
[T, Y] = ode45('RozwODE', (0:0.001:15), [0,10]);
figure;
hold on;
plot(t(1:length(x1v),1),x1v);
plot(T,Y(:,1));
title("x1(t)");
ylabel("x1");
xlabel("t");
legend("rk4 zmienny krok","ode45");
hold off;
figure;
hold on;
plot(t(1:length(x2v),1),x2v);
plot(T,Y(:,2));
title("x2(t)");
xlabel("t");
ylabel("x2");
legend("rk4 zmienny krok","ode45");
hold off;
figure;
hold on;
plot(x1v,x2v);
plot(Y(:,1),Y(:,2));
title("x2(x1)");
xlabel("x1");
ylabel("x2");
legend("rk4 zmienny krok","ode45");
hold off;
figure;
hold on;
plot(t(1:length(E1)), E1);
plot(t(1:length(E2)), E2);
title("error1(t),error2(t)");
xlabel("t");
ylabel("error1,erroe2");
legend("error1","error2");
hold off;
figure;
plot(t(1:length(H)), H);
title("h(t)");
ylabel("h");
xlabel("t");
